/* empty css             *//* empty css                     *//* empty css                *//* empty css                  *//* empty css              *//* empty css                  *//* empty css               *//* empty css               *//* empty css                   *//* empty css                */import{r as w}from"./request-54d9b062.js";/* empty css                    */import{r as I,o as m,c as N,b as c,d as t,w as a,g as p,G as T,D as U,H as M,I as P,J,y as s,t as _,f,C as g,K as $,L as q,Z as F,R,S as A,M as G,O as H}from"./index-fdd1b0eb.js";const K={class:"card",style:{"margin-bottom":"10px"}},L={class:"card",style:{"margin-bottom":"10px"}},Z={style:{color:"red"}},j={key:0,class:"card"},Q={class:"dialog-footer"},pe={__name:"OrderManager",setup(W){const e=I({user:JSON.parse(localStorage.getItem("canteen-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:5,formVisible:!1,form:{},userName:"",time:""}),d=()=>{w.get("/orders/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,userName:e.userName,userId:e.user.role==="USER"?e.user.id:null}}).then(r=>{var l;e.tableData=((l=r.data)==null?void 0:l.list)||[],e.total=r.data.total,e.time=r.data.time})};d();const V=()=>{e.userName=null,d()},k=()=>{w.request({method:e.form.id?"PUT":"POST",url:e.form.id?"/orders/update":"/orders/add",data:e.form}).then(r=>{r.code==="200"?(g.success("操作成功"),e.formVisible=!1,d()):g.error(r.msg)})},h=r=>{e.form=JSON.parse(JSON.stringify(r)),e.formVisible=!0},x=r=>{$.confirm("删除后数据无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(l=>{w.delete("/orders/delete/"+r).then(u=>{u.code==="200"?(g.success("操作成功"),d()):g.error(u.msg)})}).catch(l=>{console.log(l)})};function E(){window.open("http://localhost:9090/orders/export")}return(r,l)=>{const u=T,i=U,n=q,y=F,C=M,S=P,b=R,v=A,D=G,O=H,z=J;return m(),N("div",null,[c("div",K,[t(u,{"prefix-icon":"Search",style:{width:"300px","margin-right":"10px"},placeholder:"请输入用户名称查询",modelValue:e.userName,"onUpdate:modelValue":l[0]||(l[0]=o=>e.userName=o)},null,8,["modelValue"]),t(i,{type:"primary",onClick:d},{default:a(()=>[s("查询")]),_:1}),t(i,{type:"info",style:{margin:"0 10px"},onClick:V},{default:a(()=>[s("重置")]),_:1}),t(i,{type:"warning",onClick:E},{default:a(()=>[s("一键导出")]),_:1})]),c("div",L,[t(C,{data:e.tableData},{default:a(()=>[t(n,{prop:"id",label:"序号",width:"70"}),t(n,{prop:"orderNo",label:"订单编号"}),t(n,{prop:"content",label:"菜单内容"}),t(n,{prop:"time",label:"下单时间"}),t(n,{prop:"total",label:"订单总价"},{default:a(o=>[c("strong",Z,"￥"+_(o.row.total),1)]),_:1}),t(n,{prop:"userName",label:"用户名称"}),t(n,{prop:"status",label:"订单状态"},{default:a(o=>[o.row.status==="待出餐"?(m(),f(y,{key:0,type:"primary"},{default:a(()=>[s(_(o.row.status),1)]),_:2},1024)):p("",!0),o.row.status==="待结算"?(m(),f(y,{key:1,type:"warning"},{default:a(()=>[s(_(o.row.status),1)]),_:2},1024)):p("",!0),o.row.status==="已完成"?(m(),f(y,{key:2,type:"success"},{default:a(()=>[s(_(o.row.status),1)]),_:2},1024)):p("",!0)]),_:1}),e.user.role==="ADMIN"?(m(),f(n,{key:0,label:"操作",width:"180"},{default:a(o=>[t(i,{type:"primary",onClick:B=>h(o.row)},{default:a(()=>[s("编辑")]),_:2},1032,["onClick"]),t(i,{type:"danger",onClick:B=>x(o.row.id)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})):p("",!0)]),_:1},8,["data"])]),e.total?(m(),N("div",j,[t(S,{background:"",layout:"prev, pager, next",onCurrentChange:d,"page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":l[1]||(l[1]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):p("",!0),t(z,{modelValue:e.formVisible,"onUpdate:modelValue":l[4]||(l[4]=o=>e.formVisible=o),title:"信息",width:"30%","destroy-on-close":""},{footer:a(()=>[c("span",Q,[t(i,{onClick:l[3]||(l[3]=o=>e.formVisible=!1)},{default:a(()=>[s("取消")]),_:1}),t(i,{type:"primary",onClick:k},{default:a(()=>[s("保存")]),_:1})])]),default:a(()=>[t(O,{model:e.form,"label-width":"100px",style:{"padding-right":"50px"}},{default:a(()=>[t(D,{label:"订单状态"},{default:a(()=>[t(v,{style:{width:"100%"},modelValue:e.form.status,"onUpdate:modelValue":l[2]||(l[2]=o=>e.form.status=o)},{default:a(()=>[t(b,{value:"待出餐"}),t(b,{value:"待结算"}),t(b,{value:"已完成"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{pe as default};
